(this["webpackJsonpaid-platform"]=this["webpackJsonpaid-platform"]||[]).push([[0],{35:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){},70:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){},81:function(e,t,n){},82:function(e,t,n){},84:function(e,t,n){"use strict";n.r(t);var s=n(0),a=n(1),r=n.n(a),o=n(28),i=n.n(o),c=(n(50),n(51),n(4)),l=n(5),d=n(7),u=n(6),h=(n(52),n.p+"static/media/kelvin-logo.1abaff0d.png"),m=(n(53),function(e){return Object(s.jsx)("div",{className:"Logoo",children:Object(s.jsx)("img",{src:h,alt:"MyBurger"})})}),j=n(10),f=(n(54),n(55),function(e){return Object(s.jsx)("li",{className:"NavigationItem",children:Object(s.jsx)(j.b,{to:e.link,onClick:e.navSelected,children:e.children})})}),p=function(e){return e.currentUser?Object(s.jsxs)("ul",{className:"NavigationItems",children:[Object(s.jsx)(f,{navSelected:e.clicked,link:"/home",children:"Home"}),Object(s.jsx)(f,{navSelected:e.clicked,link:"/inbox",children:"Inbox"}),Object(s.jsx)(f,{navSelected:e.clicked,link:"/request",children:"Request"}),Object(s.jsx)("li",{className:"NavigationItem",children:Object(s.jsx)(j.b,{to:"/signin",onClick:e.signout,children:"Logout"})})]}):Object(s.jsxs)("ul",{className:"NavigationItems",children:[Object(s.jsx)(f,{link:"/signup",children:"SignUp"}),Object(s.jsx)(f,{link:"/signin",children:"SignIn"})]})},b=(n(60),function(e){return Object(s.jsxs)("div",{className:"DrawerToggle",onClick:e.clicked,children:[Object(s.jsx)("div",{}),Object(s.jsx)("div",{}),Object(s.jsx)("div",{})]})}),v=function(e){return Object(s.jsxs)("header",{className:"Toolbar",children:[Object(s.jsx)("div",{style:{height:"100%",padding:"1px"},children:Object(s.jsxs)(j.b,{to:"/home",children:[" ",Object(s.jsx)(m,{})," "]})}),Object(s.jsx)("nav",{className:"DesktopOnly",children:Object(s.jsx)(p,{currentUser:e.currentUser,signout:e.signout})}),Object(s.jsx)(b,{clicked:e.drawerToggleClicked})]})},g=n(2),O=(n(61),n(62),function(e){return e.show?Object(s.jsx)("div",{className:"Backdrop",onClick:e.clicked}):null}),x={transform:"translateX(0)"},S={transform:"translateX(-100%)"},C=function(e){var t=Object(g.a)({},S);return e.open&&(t=Object(g.a)({},x)),Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(O,{show:e.open,clicked:e.closed}),Object(s.jsxs)("div",{style:t,className:"SideDrawer",children:[Object(s.jsx)("div",{className:"Logo",children:Object(s.jsx)(m,{})}),Object(s.jsx)("nav",{children:Object(s.jsx)(p,{currentUser:e.currentUser,clicked:e.drawerToggleClicked})})]})]})},y=(n(63),n.p+"static/media/logo.103b5fa1.svg"),N=n(21),k=n(22),q=function(e){return Object(s.jsx)("div",{className:"SideBar",children:Object(s.jsx)("header",{id:"header",children:Object(s.jsxs)("div",{className:"d-flex flex-column justify-content-center text-center",children:[Object(s.jsxs)("div",{className:"profile mt-5",children:[Object(s.jsx)("img",{src:y,alt:"",className:"img-fluid rounded-circle"}),Object(s.jsx)("h2",{children:"Aid Platform"}),Object(s.jsx)("div",{className:"social-links mt-3 text-center"})]}),e.currentUser?Object(s.jsx)("nav",{className:"nav-menu d-flex flex-column mt-3",children:Object(s.jsxs)("ul",{children:[Object(s.jsx)(j.b,{to:"/home",children:Object(s.jsxs)("li",{children:[Object(s.jsx)(N.a,{icon:k.b})," ",Object(s.jsx)("span",{children:"Volunteer To Help"})]})}),Object(s.jsx)(j.b,{to:"/request",children:Object(s.jsxs)("li",{children:[Object(s.jsx)(N.a,{icon:k.c})," ",Object(s.jsx)("span",{children:"Ask For Help"})]})})]})}):null]})})})},T=(n(67),n(20)),I=(n(68),function(){var e=Object(a.useState)(!1),t=Object(T.a)(e,2),n=t[0],r=t[1];return window.addEventListener("scroll",(function(){!n&&window.pageYOffset>400?r(!0):n&&window.pageYOffset<=400&&r(!1)})),Object(s.jsx)("div",{className:"ScrollArrow",onClick:function(){window.scrollTo({top:0,behavior:"smooth"})},style:{height:40,display:n?"flex":"none"},children:Object(s.jsx)("button",{className:"btn pb-5",children:Object(s.jsx)("span",{children:Object(s.jsx)(N.a,{icon:k.a})})})})}),w=function(){return JSON.parse(localStorage.getItem("user"))},L=function(){localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("name")},R=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(c.a)(this,n);for(var s=arguments.length,a=new Array(s),r=0;r<s;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).componentDidMount=function(){e.setState({currentUser:w()})},e.state={showSideDrawer:!1,navBarColor:!0,currentUser:null,authenticated:!1},e.sideDrawerClosedHandler=function(){e.setState({showSideDrawer:!1})},e.sideDrawerToggleHandler=function(){e.setState((function(e){return{showSideDrawer:!e.showSideDrawer}}))},e.signout=function(){L(),e.setState({currentUser:null})},e}return Object(l.a)(n,[{key:"render",value:function(){return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(v,{navBarColor:this.state.navBarColor,drawerToggleClicked:this.sideDrawerToggleHandler,currentUser:this.state.currentUser,signout:this.signout}),Object(s.jsx)("div",{className:"",children:Object(s.jsxs)("div",{className:"row",children:[Object(s.jsx)("div",{className:"col-md-3",children:Object(s.jsx)(q,{currentUser:this.state.currentUser})}),Object(s.jsxs)("div",{className:"col-md-9",children:[Object(s.jsx)(C,{currentUser:this.state.currentUser,open:this.state.showSideDrawer,closed:this.sideDrawerClosedHandler,drawerToggleClicked:this.sideDrawerClosedHandler}),Object(s.jsx)("main",{className:"Layout",children:this.props.children})]})]})}),Object(s.jsx)(I,{})]})}}]),n}(a.Component),E=n(8),F=n(25),A=n.n(F),U=n(34),_=(n(70),n(71),n(72),n(39)),M=n(86),D=n(89),P=n(90),B=n(87),H=n(88),z=n(11),V=n.n(z),J=V.a.icon({iconUrl:_.a,iconAnchor:[22,94],popupAnchor:[-3,-76],shadowSize:[68,95],shadowAnchor:[22,94]}),Y=V.a.icon({iconUrl:"https://img.icons8.com/color/48/000000/marker.png",iconAnchor:[22,94],popupAnchor:[-3,-76],shadowSize:[68,95],shadowAnchor:[22,94]}),G={color:"#008000",fillColor:"green",fillOpacity:.5},K=function(e){return Object(s.jsxs)(M.a,{center:e.location,zoom:13,scrollWheelZoom:!1,style:{height:"500px"},children:[Object(s.jsx)(D.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),Object(s.jsx)(P.a,{center:e.location,pathOptions:G,radius:200,children:Object(s.jsx)(B.a,{children:"You Are Here"})}),e.requests.map((function(t,n){return Object(s.jsx)(H.a,{position:t.latlng,icon:"one_time"==t.request_type?Y:J,eventHandlers:{click:function(){e.clicked(t)}}},n)}))]})},W=(n(73),function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(s.jsx)(s.Fragment,{children:Object(s.jsx)("div",{className:this.props.show?"ModalReact display-block":"ModalReact display-none",children:Object(s.jsx)("section",{className:"main",children:this.props.children})})})}}]),n}(a.Component)),Z=n(35),X=n.n(Z),$=function(e){return Object(s.jsx)("button",Object(g.a)(Object(g.a)({},e),{},{className:[X.a.Button,X.a[e.btnType]].join(" "),onClick:e.clicked,children:e.children}))},Q=function(e){return Object(s.jsx)(s.Fragment,{children:e.request.id&&Object(s.jsxs)("div",{children:[Object(s.jsx)("h3",{children:"Help Request Details"}),Object(s.jsx)("p",{children:Object(s.jsxs)("strong",{children:["Description: ",e.request.description]})}),Object(s.jsx)("p",{children:Object(s.jsxs)("strong",{children:["Request Type: ",e.request.request_type.replace("_"," ")]})}),Object(s.jsx)("p",{children:Object(s.jsxs)("strong",{children:["Status: ",e.request.fulfilled?"Fulfilled":"Unfulfilled"]})}),Object(s.jsx)($,{className:"btn btn-primary m-2",btnType:"Success",disabled:e.request.user_id==e.currentUser.id,clicked:e.volunteer,children:" VOLUNTEER "}),Object(s.jsx)($,{className:"m-2",btnType:"Danger",clicked:e.closed,children:" CANCEL "})]})})},ee=function(e){se[0]=parseFloat(e.coords.latitude.toFixed(3)),se[1]=parseFloat(e.coords.longitude.toFixed(3))},te=function(e){switch(e.code){case e.PERMISSION_DENIED:alert("You denied the request for your location.");break;case e.POSITION_UNAVAILABLE:alert("Your Location information is unavailable.");break;case e.TIMEOUT:alert("Your request timed out. Please try again");break;case e.UNKNOWN_ERROR:alert("An unknown error occurred please try again after some time.")}},ne={enableHighAccuracy:!0},se=[],ae=function(){return navigator.geolocation?navigator.geolocation.getCurrentPosition(ee,te,ne):alert("Geolocation is not supported by this browser."),se},re="https://aid-platform-rails.herokuapp.com",oe=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).fetchRequests=function(){var e="".concat(re,"/api/v1/requests");fetch(e,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}}).then((function(e){return e.json()})).then((function(e){if(e.total>0){var t=e.requests.map((function(e){var t={};return(t=Object(g.a)(Object(g.a)({},e),{},{latlng:[]})).latlng.push(e.lat,e.lng),t}));s.setState({requests:t})}s.setState({isLoading:!1})}),(function(e){console.log("Error > ",e),s.setState({isLoading:!1,error:e})}))},s.updateRequest=function(e){var t="".concat(re,"/api/v1/requests/").concat(e.id);fetch(t,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){s.setState({isLoading:!1,request:e.data})}),(function(e){console.log("Error > ",e),s.setState({isLoading:!1,error:e})}))},s.createVolunteer=function(e){var t="".concat(re,"/api/v1/volunteers");fetch(t,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){s.setState({isLoading:!1})}),(function(e){console.log("Error > ",e),s.setState({isLoading:!1,error:e})}))},s.createConversation=function(e){console.log("createConversation ",e);var t="".concat(re,"/api/v1/conversations");fetch(t,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){s.setState({conversationId:e.id,isLoading:!1})}),(function(e){console.log("Error > ",e),s.setState({isLoading:!1,error:e})}))},s.requestHandler=function(e){s.setState({request:e,requestSelected:!0})},s.requestConvo=function(e){s.setState({request:e,requestSelected:!0})},s.requestCancel=function(){s.setState({requestSelected:!1})},s.handleVolunteer=function(){var e=Object(g.a)({},s.state.request),t={recipient_id:e.user_id,sender_id:s.state.currentUser.id,request_id:e.id};s.createConversation(t);var n={user_id:s.state.currentUser.id,request_id:e.id};s.createVolunteer(n)},s.handleResponse=Object(U.a)(A.a.mark((function e(){var t,n,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t="".concat(re,"/api/v1/responses"),e.next=4,fetch(t,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({request_id:s.state.request.id})});case 4:return n=e.sent,e.next=7,n.json();case 7:a=e.sent,s.setState({responseId:a.data.id}),s.props.history.push("/chat?responseId=".concat(s.state.responseId)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])}))),s.createResponse=Object(U.a)(A.a.mark((function e(){var t,n,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t="".concat(re,"/api/v1/responses"),e.next=4,fetch(t,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({request_id:s.state.request.id})});case 4:return n=e.sent,e.next=7,n.json();case 7:a=e.sent,s.setState({responseId:a.data.id}),s.props.history.push("/chat?responseId=".concat(s.state.responseId)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])}))),s.state={error:null,isLoading:!0,requests:[],places:[],request:{},requestSelected:!1,location:[],conversationId:null,responseId:null,currentUser:w()},s}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.fetchRequests(),this.setState({location:ae()})}},{key:"handleClick",value:function(){this.props.history.push("/conversation")}},{key:"render",value:function(){return Object(s.jsx)("div",{className:"Home",children:Object(s.jsxs)("div",{className:"hero-container mb-5",children:[Object(s.jsx)("div",{children:Object(s.jsxs)("h1",{children:["Unfufilled Requests: ",this.state.requests.length]})}),this.state.location.length>1&&Object(s.jsx)(K,{location:this.state.location,requests:this.state.requests,clicked:this.requestHandler}),Object(s.jsx)(W,{show:this.state.requestSelected,modalClosed:this.requestCancel,open:this.state.requestSelected,closed:this.requestCancel,children:Object(s.jsx)(Q,{currentUser:this.state.currentUser,responseId:this.state.responseId,volunteer:this.handleResponse,closed:this.requestCancel,request:this.state.request})})]})})}}]),n}(a.Component),ie=n(40),ce=(n(74),function(e){var t="form-control";return e.touched&&!e.valid&&(t="form-control control-error"),Object(s.jsx)("div",{className:"form-group",children:Object(s.jsx)("input",Object(g.a)({type:e.type,className:t},e))})}),le=function(e){var t="form-control";return e.touched&&!e.valid&&(t="form-control control-error"),Object(s.jsx)("div",{className:"form-group",children:Object(s.jsx)("select",Object(g.a)(Object(g.a)({className:t},e),{},{children:e.options.map((function(e,t){return Object(s.jsx)("option",{value:e.toLowerCase().replace(" ","_"),children:e},t)}))}))})},de=function(e,t){return e.length>=t},ue=function(e,t){return e.length<=t},he=function(e){return""!==e.trim()},me=function(e){return Number(e)===e&&e%1!==0},je=function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())},fe=function(e,t){var n=!0;for(var s in t)switch(s){case"minLength":n=n&&de(e,t[s]);break;case"maxLength":n=n&&ue(e,t[s]);break;case"isRequired":n=n&&he(e);break;case"isRequiredNumber":n=n&&me(e);break;case"isEmail":n=n&&je(e);break;default:n=!0}return n},pe=(n(75),function(e){return e.show?Object(s.jsx)("div",{className:"Loader"}):null}),be=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(c.a)(this,n);for(var s=arguments.length,a=new Array(s),r=0;r<s;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).onClick=function(){var t=e.props,n=t.label;(0,t.onClick)(n)},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this.onClick,t=this.props,n=t.activeTab,a=t.label,r="tab-list-item";return n===a&&(r+=" tab-list-active"),Object(s.jsx)("li",{className:r,onClick:e,children:a})}}]),n}(a.Component),ve=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).onClickTabItem=function(e){s.setState({activeTab:e})},s.state={activeTab:s.props.children[0].props.label},s}return Object(l.a)(n,[{key:"render",value:function(){var e=this.onClickTabItem,t=this.props.children,n=this.state.activeTab;return Object(s.jsxs)("div",{className:"tabs",children:[Object(s.jsx)("ol",{className:"tab-list",children:t.map((function(t){var a=t.props.label;return Object(s.jsx)(be,{activeTab:n,label:a,onClick:e},a)}))}),Object(s.jsx)("div",{className:"tab-content",children:t.map((function(e){if(e.props.label===n)return e.props.children}))})]})}}]),n}(a.Component),ge=n(41),Oe=n.n(ge),xe={enableHighAccuracy:!0},Se=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).getLocation=function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(e.updatePosition,e.showError,xe):alert("Geolocation is not supported by this browser.")},e.updatePosition=function(t){var n=Object(g.a)({},e.state.formControls);n.lat.value=t.coords.latitude.toFixed(3),n.lng.value=t.coords.longitude.toFixed(3),n.lat.valid=fe(t.coords.latitude,n.lat.validationRules),n.lng.valid=fe(t.coords.longitude,n.lng.validationRules);var s=!0;for(var a in n)s=n[a].valid&&s;e.setState({formControls:n,formIsValid:s})},e.showError=function(e){switch(e.code){case e.PERMISSION_DENIED:alert("You denied the request for your location.");break;case e.POSITION_UNAVAILABLE:alert("Your Location information is unavailable.");break;case e.TIMEOUT:alert("Your request timed out. Please try again");break;case e.UNKNOWN_ERROR:alert("An unknown error occurred please try again after some time.")}},e.fetchRequests=function(t){var n="".concat(re,"/api/v1/requests/user/").concat(t);fetch(n,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}}).then((function(e){return e.json()})).then((function(t){var n=t.requests.slice().sort((function(e,t){return e.created_at>t.created_at?-1:1}));e.setState({isLoading:!1,requests:n})}),(function(t){console.log("Error > ",t),e.setState({isLoading:!1,error:t})}))},e.updateRequest=function(t){var n="".concat(re,"/api/v1/requests/").concat(t.id);fetch(n,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(t){e.setState({isLoading:!1,request:t.data,disabled:!e.state.disabled})}),(function(t){console.log("Error > ",t),e.setState({isLoading:!1,error:t})}))},e.handleUpdate=function(t){var n=Object(g.a)({},t);n.fulfilled=!n.fulfilled,e.updateRequest(n)},e.republishRequest=function(t){var n="".concat(re,"/api/v1/requests/republish/").concat(t);fetch(n,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:null}).then((function(e){return e.json()})).then((function(t){e.setState({isLoading:!1}),e.props.history.push("/home")}),(function(t){console.log("Error > ",t),e.setState({isLoading:!1,error:t})}))},e.handleRepublish=function(t){e.republishRequest(t)},e.changeHandler=function(t){var n=t.target.name,s=t.target.value,a=Object(g.a)({},e.state.formControls),r=Object(g.a)({},a[n]);Number(s)===s&&s%1!==0&&(Object(ie.a)("value"),s=s.toFixed(2)),r.value=s,r.valid=fe(s,r.validationRules),a[n]=r;var o=!0;for(var i in a)o=a[i].valid&&o;e.setState({formControls:a,formIsValid:o})},e.onSubmitForm=function(t){e.setState({isLoading:!0}),t.preventDefault();var n={};for(var s in e.state.formControls)n[s]=e.state.formControls[s].value;e.submitFormToApi(n)},e.submitFormToApi=function(t){var n="".concat(re,"/api/v1/requests");fetch(n,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(t){e.setState({isLoading:!1}),"00"===t.status?e.setState({formControls:e.initialFormState(),formIsValid:!1,formSuccess:!0}):e.setState({formFailure:!0,formMessage:t.message})})).catch((function(t){e.setState({isLoading:!1}),console.error("Error:",t)}))},e.state={isLoading:!1,error:null,formIsValid:!1,formControls:e.initialFormState(),formSuccess:!1,formFailure:!1,formMessage:null,allRequests:!0,requests:[],currentUser:w(),disabled:!1},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.fetchRequests(this.state.currentUser.id)}},{key:"initialFormState",value:function(){return{description:{value:"",valid:!1,validationRules:{minLength:10,maxLength:300,isRequired:!0},placeholderText:"Enter Description",touched:!1},request_type:{value:"one_time",valid:!0,options:["One Time","Material Need"],placeholderText:"Select Type"},lat:{value:"",placeholderText:"Latitude",touched:!1},lng:{value:"",placeholderText:"Longitude",touched:!1}}}},{key:"render",value:function(){var e=this,t=this.state,n=t.error,a=t.isLoading,r=t.requests;return n?Object(s.jsxs)("div",{children:["Error: ",n.message]}):a?Object(s.jsx)(pe,{show:this.state.isLoading}):Object(s.jsx)("div",{className:"Request",children:Object(s.jsxs)("div",{className:"container",children:[Object(s.jsx)("div",{className:"section-title",children:Object(s.jsx)("h2",{children:"Requests"})}),Object(s.jsx)("div",{className:"row d-flex justify-content-center",children:Object(s.jsx)("div",{className:"col-12",children:Object(s.jsxs)(ve,{children:[Object(s.jsxs)("div",{label:"Request Form",children:[this.state.formSuccess?Object(s.jsx)("h3",{children:"Your Request Has Been Submitted. Thank You!"}):null,Object(s.jsxs)("form",{className:"Contact",children:[Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{children:"Description:"}),Object(s.jsx)(ce,{name:"description",type:"text",placeholder:this.state.formControls.description.placeholderText,value:this.state.formControls.description.value,onChange:this.changeHandler,touched:this.state.formControls.description.touched,valid:this.state.formControls.description.valid})]}),Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{children:"Type:"}),Object(s.jsx)(le,{name:"request_type",placeholder:this.state.formControls.request_type.placeholderText,value:this.state.formControls.request_type.value,onChange:this.changeHandler,options:this.state.formControls.request_type.options})]}),Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{children:"Location:"}),Object(s.jsxs)("div",{className:"d-flex flex-row",children:[Object(s.jsx)(ce,{name:"lat",type:"number",placeholder:this.state.formControls.lat.placeholderText,value:this.state.formControls.lat.value,onChange:this.changeHandler,touched:this.state.formControls.lat.touched,valid:this.state.formControls.lat.valid}),Object(s.jsx)(ce,{name:"lng",type:"number",className:"form-control ml-3",placeholder:this.state.formControls.lng.placeholderText,value:this.state.formControls.lng.value,onChange:this.changeHandler,touched:this.state.formControls.lng.touched,valid:this.state.formControls.lng.valid}),Object(s.jsx)("div",{className:"form-group",children:Object(s.jsx)("button",{className:"btn btn-primary mx-4",type:"button",onClick:this.getLocation,children:"Get My Location"})})]})]}),Object(s.jsx)("button",{className:"btn btn-primary",onClick:this.onSubmitForm,disabled:!this.state.formIsValid,children:" Submit Request "})]})]}),Object(s.jsx)("div",{label:"Requests",children:Object(s.jsxs)("table",{className:"table",children:[Object(s.jsx)("thead",{children:Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{scope:"col",children:"#"}),Object(s.jsx)("th",{scope:"col",children:"Description"}),Object(s.jsx)("th",{scope:"col",children:"Request Type"}),Object(s.jsx)("th",{scope:"col",children:"Date"}),Object(s.jsx)("th",{scope:"col",children:"Mark As Fufilled"}),Object(s.jsx)("th",{scope:"col",children:"Responses Count"}),Object(s.jsx)("th",{scope:"col",children:"Republish"})]})}),Object(s.jsx)("tbody",{children:r.map((function(t,n){return Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{scope:"row",children:n+1}),Object(s.jsx)("td",{children:t.description}),Object(s.jsx)("td",{children:t.request_type.replace("_"," ")}),Object(s.jsx)("td",{children:Oe()(t.created_at).format("MM/DD/YYYY")}),Object(s.jsx)("td",{children:Object(s.jsx)("div",{className:"form-check",children:Object(s.jsx)("input",{className:"form-check-input position-static",type:"checkbox",defaultChecked:t.fulfilled,name:t.description,id:t.id,value:t,disabled:t.fulfilled,onClick:function(){return e.handleUpdate(t)}})})}),Object(s.jsx)("td",{children:t.responses_count}),Object(s.jsx)("td",{onClick:function(){return e.handleRepublish(t.id)},children:Object(s.jsx)("button",{disabled:!(!t.fulfilled&&t.is_republishable),className:"btn btn-primary",children:" Click "})})]},t.id)}))})]})})]})})})]})})}}]),n}(a.Component),Ce=(n(77),n(16)),ye=function(e){var t="form-control";e.touched&&!e.valid&&(t="form-control control-error");var n=Object(g.a)({},e),a=(n.valid,Object(Ce.a)(n,["valid"]));return Object(s.jsx)("div",{className:"form-group",children:Object(s.jsx)("input",Object(g.a)({type:"email",className:t},a))})},Ne=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).changeHandler=function(t){var n=t.target.name,s=t.target.value,a=Object(g.a)({},e.state.formControls),r=Object(g.a)({},a[n]);r.value=s,r.touched=!0,r.valid=fe(s,r.validationRules),a[n]=r;var o=!0;for(var i in a)o=a[i].valid&&o;e.setState({formControls:a,formIsValid:o})},e.onSubmitForm=function(t){localStorage.removeItem("token"),e.setState({isLoading:!0}),t.preventDefault();var n={};for(var s in e.state.formControls)n[s]=e.state.formControls[s].value;e.submitFormToApi(n)},e.submitFormToApi=function(t){var n="".concat(re,"/api/v1/login");fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:t})}).then((function(e){if(e.ok){var t=e.headers.get("authorization");return t&&(n=t.split(" ")[1],localStorage.setItem("token",n)),e.json()}var n,s=new Error(e.statusText);throw s.response=e,s})).then((function(t){e.setState({isLoading:!1}),t.data?(e.setState({formControls:e.initialFormState(),formIsValid:!1,formSuccess:!0,formMessage:t.data.links.self}),function(e){var t=e.attributes;t.id=e.id,localStorage.setItem("name",t.firstname),localStorage.setItem("user",JSON.stringify(t))}(t.data),window.location.reload(),e.props.history.push("/home")):e.setState({formIsValid:!1,formFailure:!0,formMessage:t.error})})).catch((function(t){e.setState({isLoading:!1}),e.setState({formIsValid:!0,formFailure:!0,formMessage:"Network Error"}),console.error("Error:",t)}))},e.state={isLoading:!1,error:null,formIsValid:!1,formControls:e.initialFormState(),formSuccess:!1,formFailure:!1,formMessage:null},e}return Object(l.a)(n,[{key:"initialFormState",value:function(){return{email:{value:"",valid:!1,validationRules:{isRequired:!0},placeholderText:"Enter Email Address",touched:!1},password:{value:"",valid:!1,validationRules:{minLength:5,maxLength:50,isRequired:!0},placeholderText:"Enter Password",touched:!1}}}},{key:"render",value:function(){var e=this.state,t=e.error,n=e.isLoading;return t?Object(s.jsxs)("div",{children:["Error: ",t.message]}):n?Object(s.jsx)(pe,{show:this.state.isLoading}):Object(s.jsx)("div",{className:"SignIn",children:Object(s.jsxs)("div",{className:"container",children:[Object(s.jsx)("div",{className:"section-title",children:Object(s.jsx)("h2",{children:"Login"})}),Object(s.jsx)("div",{className:"row d-flex justify-content-center",children:Object(s.jsxs)("div",{className:"col-12",children:[this.state.formSuccess?Object(s.jsx)("h3",{children:this.state.formMessage}):null,this.state.formFailure?Object(s.jsx)("h3",{children:this.state.formMessage}):null,Object(s.jsxs)("form",{className:"Contact",children:[Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{children:"Email Address:"}),Object(s.jsx)(ye,{name:"email",placeholder:this.state.formControls.email.placeholderText,value:this.state.formControls.email.value,onChange:this.changeHandler,touched:this.state.formControls.email.touched.toString(),valid:this.state.formControls.email.valid.toString()})]}),Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{children:"Password:"}),Object(s.jsx)(ce,{name:"password",placeholder:this.state.formControls.password.placeholderText,value:this.state.formControls.password.value,onChange:this.changeHandler,touched:this.state.formControls.password.touched.toString(),valid:this.state.formControls.password.valid.toString(),type:"password"})]}),Object(s.jsx)("button",{className:"btn btn-primary",onClick:this.onSubmitForm,disabled:!this.state.formIsValid,children:" Log In "})]})]})})]})})}}]),n}(a.Component),ke=(n(78),function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).changeHandler=function(t){var n=t.target.name,s=t.target.value,a=Object(g.a)({},e.state.formControls),r=Object(g.a)({},a[n]);r.value=s,r.touched=!0,r.valid=fe(s,r.validationRules),a[n]=r;var o=!0;for(var i in a)o=a[i].valid&&o;e.setState({formControls:a,formIsValid:o})},e.onFileClicked=function(){e.myRef.current.files[0]&&e.setState({formIsValid:!0})},e.onSubmitForm=function(t){e.setState({isLoading:!0}),t.preventDefault();var n=new FormData;for(var s in e.state.formControls)n[s]=e.state.formControls[s].value,n.append(s,e.state.formControls[s].value);var a=e.myRef.current.files[0];n.append("picture",a),e.submitFormToApi(n)},e.submitFormToApi=function(t){var n="".concat(re,"/api/v1/signup");fetch(n,{method:"POST",body:t}).then((function(e){return e.json()})).then((function(t){e.setState({isLoading:!1}),t.data?e.setState({formControls:e.initialFormState(),formIsValid:!1,formSuccess:!0,formMessage:"Registration Successful."}):e.setState({formIsValid:!1,formFailure:!0,formMessage:t.error})})).catch((function(t){e.setState({isLoading:!1}),e.setState({formIsValid:!0,formFailure:!0,formMessage:"Network Error"}),console.error("Error:",t)}))},e.myRef=r.a.createRef(),e.state={isLoading:!1,error:null,formIsValid:!1,formControls:e.initialFormState(),formSuccess:!1,formFailure:!1,formMessage:null,file:null},e}return Object(l.a)(n,[{key:"initialFormState",value:function(){return{firstname:{value:"",valid:!1,validationRules:{minLength:5,isRequired:!0},placeholderText:"Enter First Name",touched:!1},lastname:{value:"",valid:!1,validationRules:{minLength:5,isRequired:!0},placeholderText:"Enter Last Name",touched:!1},password:{value:"",valid:!1,validationRules:{minLength:5,isRequired:!0},placeholderText:"Enter password",touched:!1},email:{value:"",valid:!1,validationRules:{isRequired:!0},placeholderText:"Enter Email Address",touched:!1},picture:{value:"",valid:!1,validationRules:{isRequired:!0},touched:!1}}}},{key:"render",value:function(){var e=this.state,t=e.error,n=e.isLoading;return t?Object(s.jsxs)("div",{children:["Error: ",t.message]}):n?Object(s.jsx)(pe,{show:this.state.isLoading}):Object(s.jsx)("div",{className:"SignUp",children:Object(s.jsxs)("div",{className:"container",children:[Object(s.jsx)("div",{className:"section-title",children:Object(s.jsx)("h2",{children:"SignUp For Help"})}),Object(s.jsx)("div",{className:"row d-flex justify-content-center",children:Object(s.jsxs)("div",{className:"col-12",children:[this.state.formSuccess?Object(s.jsx)("h3",{children:this.state.formMessage}):null,this.state.formFailure?Object(s.jsx)("h3",{children:this.state.formMessage}):null,Object(s.jsxs)("form",{className:"Contact",encType:"multipart/form-data",children:[Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{children:"First Name:"}),Object(s.jsx)(ce,{name:"firstname",placeholder:this.state.formControls.firstname.placeholderText,value:this.state.formControls.firstname.value,onChange:this.changeHandler,touched:this.state.formControls.firstname.touched,valid:this.state.formControls.firstname.valid})]}),Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{children:"Last Name:"}),Object(s.jsx)(ce,{name:"lastname",placeholder:this.state.formControls.lastname.placeholderText,value:this.state.formControls.lastname.value,onChange:this.changeHandler,touched:this.state.formControls.lastname.touched,valid:this.state.formControls.lastname.valid})]}),Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{children:"Password:"}),Object(s.jsx)(ce,{name:"password",type:"password",placeholder:this.state.formControls.password.placeholderText,value:this.state.formControls.password.value,onChange:this.changeHandler,touched:this.state.formControls.password.touched,valid:this.state.formControls.password.valid})]}),Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{children:"Email Address:"}),Object(s.jsx)(ye,{name:"email",placeholder:this.state.formControls.email.placeholderText,value:this.state.formControls.email.value,onChange:this.changeHandler,touched:this.state.formControls.email.touched,valid:this.state.formControls.email.valid})]}),Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{htmlFor:"picture",children:"Picture:"}),Object(s.jsx)("input",{type:"file",ref:this.myRef,name:"picture",onChange:this.onFileClicked,accept:"image/png, image/jpeg, image/pdf",className:"form-control-file"})]}),Object(s.jsx)("button",{className:"btn btn-primary",onClick:this.onSubmitForm,disabled:!this.state.formIsValid,children:" Sign Up "})]})]})})]})})}}]),n}(a.Component)),qe=n(18),Te=n(24),Ie=(n(79),function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).fetchMessages=function(e){var t="".concat(re,"/api/v1/messages/").concat(e);fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}}).then((function(e){return e.json()})).then((function(e){s.setState({isLoading:!1,messages:e.messages})}),(function(e){console.log("Error > ",e),s.setState({isLoading:!1,error:e})}))},s.fetchConversations=function(e){var t="".concat(re,"/api/v1/conversations/").concat(e);fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}}).then((function(e){return e.json()})).then((function(e){s.setState({isLoading:!1,messages:e.messages})}),(function(e){console.log("Error > ",e),s.setState({isLoading:!1,error:e})}))},s.fetchConversationsByRequestId=function(e){var t="".concat(re,"/api/v1/conversations/requestid/").concat(e);fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}}).then((function(e){return e.json()})).then((function(e){console.log("fetchConversationsByRequestId ",e),s.setState({conversationId:e.data.id,isLoading:!1})}),(function(e){console.log("Error > ",e),s.setState({isLoading:!1,error:e})}))},s.sendMessage=function(e){console.log("");var t="".concat(re,"/api/v1/messages");fetch(t,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(t){s.setState({isLoading:!1,message:"",messages:[].concat(Object(Te.a)(s.state.messages),[e])})}),(function(e){console.log("Error > ",e),s.setState({isLoading:!1,error:e})}))},s.submitForm=function(e){if("Enter"===e.key){var t={body:s.state.message,name:s.state.name,conversation_id:s.state.conversationId,user_id:parseInt(s.state.currentUser.id)};console.log("submitForm ",s.state.conversationId),s.sendMessage(t)}},s.handleSubmit=function(e){e.preventDefault()},s.handleChange=function(e){s.setState({message:e.target.value})},s.state={error:null,isLoading:!0,requests:[],places:[],messages:[],message:"",query:"",requestId:null,conversationId:null,name:"",currentUser:w()},s}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this.state.currentUser;this.setState({name:e.firstname+" "+e.lastname}),this.setState({requestId:this.props.location.search.split("=")[1]}),this.fetchConversationsByRequestId(this.props.location.search.split("=")[1])}},{key:"render",value:function(){var e;return Object(s.jsx)("div",{className:"Conversation",children:Object(s.jsxs)("div",{className:"container",children:[Object(s.jsx)("div",{className:"section-title",children:Object(s.jsx)("h2",{children:"Chats"})}),Object(s.jsx)("div",{className:"row d-flex flex-column justify-content-space-between",children:Object(s.jsxs)("div",{className:"col-12",children:[Object(s.jsx)("div",{className:"mb-auto",children:Object(s.jsx)("ul",{className:"message-list flex-container column",children:this.state.messages.map((function(e){return Object(s.jsxs)("li",{children:[Object(s.jsx)("div",{className:"name",children:e.name}),Object(s.jsx)("div",{className:"text",children:e.body})]},e.id)}))})}),Object(s.jsx)("div",{className:"mt-auto",children:Object(s.jsx)("div",(e={className:"form-group",onSubmit:this.handleSubmit},Object(qe.a)(e,"className","send-message-form"),Object(qe.a)(e,"children",Object(s.jsx)(ce,{name:"send-message-form",placeholder:"Type your message and hit ENTER",value:this.state.message,onChange:this.handleChange,onKeyPress:this.submitForm})),e))})]})})]})})}}]),n}(a.Component)),we=(n(80),function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).fetchMessages=function(e){var t="".concat(re,"/api/v1/responses");fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}}).then((function(e){return e.json()})).then((function(e){var t=[],n=[];e.requests.forEach((function(e){n=e.messages.map((function(t){var n={};return n.id=t.id,n.content=t.content,n.request_id=t.request_id,n.response_id=t.response_id,n.request_description=e.description,n}))}));var a=Array.from(new Set(n.map((function(e){return e.response_id})))).map((function(e){return n.find((function(t){return t.response_id===e}))}));t=[].concat(Object(Te.a)(t),Object(Te.a)(a)),e.responses.forEach((function(e){var n={id:e.id,content:e.messages[0].content,request_id:e.request_id,response_id:e.id,request_description:e.request.description};t.push(n)})),s.setState({isLoading:!1,inbox:t})}),(function(e){console.log("Error > ",e),s.setState({isLoading:!1,error:e})}))},s.state={error:null,isLoading:!0,requests:[],places:[],request:null,requestSelected:!1,messages:[],message:"",query:"",requestId:null,currentUser:w(),inbox:[]},s}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.fetchMessages(this.state.currentUser.id)}},{key:"render",value:function(){return Object(s.jsx)("div",{className:"Inbox",children:Object(s.jsxs)("div",{className:"container",children:[Object(s.jsx)("div",{className:"section-title",children:Object(s.jsx)("h2",{children:"Inbox..."})}),Object(s.jsx)("div",{className:"row d-flex flex-column justify-content-space-between",children:Object(s.jsx)("div",{className:"col-12",children:Object(s.jsx)("div",{className:"card mb-auto",children:Object(s.jsx)("ul",{className:"list-group list-group-flush message-list flex-container column",children:this.state.inbox.map((function(e){return Object(s.jsx)(j.b,{to:"/chat?response_id=".concat(e.response_id),children:Object(s.jsxs)("li",{className:"list-group-item",children:[Object(s.jsx)("div",{className:"name",children:e.request_description}),Object(s.jsx)("div",{className:"text",children:e.content})]},e.id)},e.id)}))})})})})]})})}}]),n}(a.Component)),Le=n(42),Re=(n(81),function(e){var t="form-control-file";return e.touched&&!e.valid&&(t="form-control-file control-error"),Object(s.jsx)("div",{className:"form-group",children:Object(s.jsx)("input",Object(g.a)(Object(g.a)({type:"file",ref:e.ref,accept:"image/png, image/jpeg, image/pdf",className:t},e),{},{id:e.name}))})}),Ee=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).updatePicture=function(e){var t="".concat(re,"/api/v1/user");fetch(t,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){s.setState({isLoading:!1,requests:e.requests})}),(function(e){console.log("Error > ",e),s.setState({isLoading:!1,error:e})}))},s.handleSubmit=function(e){e.preventDefault(),s.props.sendMessage(s.state.message),s.setState({message:""})},s.handleChange=function(e){s.setState({picture:e.target.value})},s.onSubmitForm=function(e){s.setState({isLoading:!0}),e.preventDefault();var t=new FormData,n=document.querySelector('input[type="file"]');console.log("fileField ",n);var a=document.getElementById("picture");if(a.files[0]){var r=a.files[0];t.append("picture",r);var o,i=Object(Le.a)(t.entries());try{for(i.s();!(o=i.n()).done;){var c=o.value;console.log(c[0]+", "+c[1])}}catch(l){i.e(l)}finally{i.f()}s.updatePicture(t)}},s.state={error:null,isLoading:!0,picture:"",currentUser:w()},s}return Object(l.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.state.currentUser;return Object(s.jsx)("div",{className:"Inbox",children:Object(s.jsxs)("div",{className:"container",children:[Object(s.jsx)("div",{className:"section-title",children:Object(s.jsx)("h2",{children:"Profile"})}),Object(s.jsx)("div",{className:"row d-flex flex-column justify-content-space-between",children:Object(s.jsxs)("div",{className:"col-12",children:[Object(s.jsxs)("div",{className:"",children:[Object(s.jsxs)("p",{children:["First name: ",e.firstname]}),Object(s.jsxs)("p",{children:["Last name: ",e.lastname]}),Object(s.jsxs)("p",{children:["Email: ",e.email]}),Object(s.jsxs)("p",{children:["Date Registered: ",e.created_at]})]}),Object(s.jsxs)("div",{className:"form-group",children:[Object(s.jsx)("label",{children:"Picture:"}),Object(s.jsx)(Re,{name:"picture",placeholder:"Upload a picture",value:this.state.picture,onChange:this.handleChange})]}),Object(s.jsx)("button",{className:"btn btn-primary",onClick:this.onSubmitForm,children:" Save "})]})})]})})}}]),n}(a.Component),Fe=(n(82),n(43)),Ae=[{path:"/home",name:"Home",icon:"",component:oe},{path:"/request",name:"Request",icon:"",component:Se},{path:"/signup",name:"SignUp",icon:"",component:ke},{path:"/signin",name:"SignIn",icon:"",component:Ne},{path:"/conversation",name:"Conversation",icon:"",component:Ie},{path:"/inbox",name:"Inbox",icon:"",component:we},{path:"/chat",name:"Chat",icon:"",component:function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).fetchMessages=function(e){var t="".concat(re,"/api/v1/messages/").concat(e);fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}}).then((function(e){return e.json()})).then((function(e){s.setState({isLoading:!1,messages:e})}),(function(e){console.log("Error > ",e),s.setState({isLoading:!1,error:e})}))},s.fetchConversations=function(e){var t="".concat(re,"/api/v1/conversations/").concat(e);fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}}).then((function(e){return e.json()})).then((function(e){s.setState({isLoading:!1,messages:e.messages})}),(function(e){console.log("Error > ",e),s.setState({isLoading:!1,error:e})}))},s.sendMessage=function(e){var t="".concat(re,"/api/v1/messages");fetch(t,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){s.setState({isLoading:!1})}),(function(e){console.log("Error > ",e),s.setState({isLoading:!1,error:e})}))},s.submitForm=function(e){if("Enter"===e.key){var t={content:s.state.message,response_id:parseInt(s.state.responseId),user_id:parseInt(s.state.currentUser.id)};s.sendMessage(t)}},s.handleSubmit=function(e){e.preventDefault()},s.handleChange=function(e){s.setState({message:e.target.value})},s.state={error:null,isLoading:!0,requests:[],places:[],messages:[],message:"",query:"",requestId:null,responseId:null,name:"",currentUser:w()},s}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.setState({responseId:this.props.location.search.split("=")[1]}),this.fetchMessages(this.props.location.search.split("=")[1]),this.createSocket()}},{key:"createSocket",value:function(){var e=this,t=Object(Fe.createConsumer)("wss://aid-platform-rails.herokuapp.com/cable");this.chats=t.subscriptions.create({channel:"MessagesChannel",id:this.props.location.search.split("=")[1]},{connected:function(){console.log("Connected")},disconnected:function(){console.log("disconnected")},received:function(t){var n={id:t.id,user:{firstname:t.firstname},content:t.content},s=e.state.messages;s.push(n),e.setState({messages:s,message:""})}})}},{key:"render",value:function(){var e;return Object(s.jsx)("div",{className:"Chat",children:Object(s.jsxs)("div",{className:"container",children:[Object(s.jsx)("div",{className:"section-title",children:Object(s.jsx)("h2",{children:"Chats"})}),Object(s.jsx)("div",{className:"row d-flex flex-column justify-content-space-between",children:Object(s.jsxs)("div",{className:"col-12",children:[Object(s.jsx)("div",{className:"mb-auto",children:Object(s.jsx)("ul",{className:"message-list flex-container column",children:this.state.messages.map((function(e){return Object(s.jsxs)("li",{children:[Object(s.jsx)("div",{className:"name",children:e.user.firstname}),Object(s.jsx)("div",{className:"text",children:e.content})]},e.id)}))})}),Object(s.jsx)("div",{className:"mt-auto",children:Object(s.jsx)("div",(e={className:"form-group",onSubmit:this.handleSubmit},Object(qe.a)(e,"className","send-message-form"),Object(qe.a)(e,"children",Object(s.jsx)(ce,{name:"send-message-form",placeholder:"Type your message and hit ENTER",value:this.state.message,onChange:this.handleChange,onKeyPress:this.submitForm})),e))})]})})]})})}}]),n}(a.Component)},{path:"/profile",name:"Profile",icon:"",component:Ee}];var Ue=function(){return Object(s.jsx)("div",{children:Object(s.jsxs)(R,{children:[Object(s.jsx)(E.a,{to:w()?"/home":"/signin"}),Object(s.jsx)(E.d,{children:Ae.map((function(e,t){return Object(s.jsx)(E.b,{path:e.path,component:e.component},t)}))})]})})},_e=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,91)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),s(e),a(e),r(e),o(e)}))};n(83);i.a.render(Object(s.jsx)(j.a,{children:Object(s.jsx)(Ue,{})}),document.getElementById("root")),_e()}},[[84,1,2]]]);
//# sourceMappingURL=main.08bff511.chunk.js.map